@using OxxCommerceStarterKit.Web.Helpers
@model OxxCommerceStarterKit.Web.Models.ViewModels.ImageViewModel
@{
	Layout = null;
    
    // Note! This view requires that the Model.Url is not
    // using the edit/preview url in order to append the
    // size to it.
    
	if (!string.IsNullOrEmpty(Model.Tag))
	{
		Model.Url += Html.GetImageWidth(Model.Tag);
	}
}
@if (!string.IsNullOrEmpty(Model.ExternalLink))
{
	<a href="@Model.ExternalLink" @(string.IsNullOrEmpty(Model.ExternalLinkTarget) ? "" : "target=" + Model.ExternalLinkTarget)>
		@Image()
	</a>
}
else
{
	@Image()
}
@if (!string.IsNullOrEmpty(Model.Description))
{
	<div class="image-description">@Model.Description</div>
}

@helper Image()
{
	if (Model.HotSpots != null && Model.HotSpots.Any())
	{
		var imageMapId = Guid.NewGuid().ToString();
		<div class="hotspotimage @Model.Language" data-mobile="@Model.IsMobile">
			<div class="hotspots">
				@foreach (var hotSpot in Model.HotSpots)
				{
					bool isProduct = hotSpot.IsProduct;
					if (!string.IsNullOrEmpty(hotSpot.link))
					{
						<a class="hotspot" style="display: none;"
						   data-top="@hotSpot.hotSpot.top.ToString().Replace(",", ".")"
						   data-left="@hotSpot.hotSpot.left.ToString().Replace(",", ".")"
						   data-width="@hotSpot.hotSpot.width"
						   data-height="@hotSpot.hotSpot.height"
						   data-area-top="@hotSpot.area.top.ToString().Replace(",", ".")"
						   data-area-left="@hotSpot.area.left.ToString().Replace(",", ".")"
						   data-area-width="@hotSpot.area.width.ToString().Replace(",", ".")"
						   data-area-height="@hotSpot.area.height.ToString().Replace(",", ".")"
						   href="@(isProduct ? "javascript:;" : @Url.ContentUrl(hotSpot.ContentLink))" @(isProduct ? "data-product-id=" + hotSpot.link : "")>
						</a>
					}
				}
			</div>
			<img src="@Model.Url" alt="@(string.IsNullOrEmpty(Model.Description) ? Model.Name : Model.Description)" title="@Model.Copyright" class="image-file img-responsive" usemap="#@imageMapId" />
			<map name="@imageMapId">@* generated by javascript *@</map>
		</div>
	}
	else
	{
		<img src="@Model.Url" alt="@(string.IsNullOrEmpty(Model.Description) ? Model.Name : Model.Description)" title="@Model.Copyright" class="image-file img-responsive" />
	}

}